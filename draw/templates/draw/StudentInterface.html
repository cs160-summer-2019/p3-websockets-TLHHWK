{% load static %}

<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>P4 Drawing</title>

    <link rel="stylesheet" type="text/css" href="{% static 'draw/vendor/bootstrap/css/bootstrap.min.css' %}">
    <script type="text/javascript" src="{% static 'draw/vendor/jquery/jquery-3.3.1.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'draw/vendor/paper/paper-full.min.js' %}"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  
<!--     CSS书写顺序
1.位置属性 (position, top, right, z-index, display, float等)　　
2.大小 (width, height, padding, margin)　　
3.文字系列 (font, line-height, letter-spacing, color- text-align等)　　
4.背景 (background, border等)
5.其他 (animation, transition等) -->
    <style type="text/css">
      .name
      {
        font-size: 25px;
        font-family: Arial;
        font-weight:bolder;
      }
      .Title
      {
        position: absolute;
        top:100px;
        left:300px;
        text-align:center;
        width:50%;/*定宽*/
        height:auto;
        font-size: 30px;
        font-family: Arial;
        font-weight:bolder;
        background:yellow;
      }
      
        .InputBox 
      {
        position:absolute;
	      top:200px;
        left:550px;
	      width:200px;
        height:40px;
	      vertical-align:middle;
        font-family:Arial;
	      font-size:40px；
       background: transparent;
  border: none;
  border-bottom: 1px solid #000000;
  -webkit-box-shadow: none;
  box-shadow: none;
  border-radius: 0;
	    }
      
      .NameBox {
          border: none;
          background-color: none;
          outline: 0;
          font-size: 25px;
          width: 300px;
          height: 30px;
          text-align:center;
      }
      
        .SubmitButton
        {
        position:absolute;
	      top:200px;
        left:800px;
        background-color:black;
        color:white;
        opacity:0.6;
        }
      
      .HelpButton
        {
        position:absolute;
	      top:200px;
        left:900px;
        background-color:black;
        color:white;
        opacity:0.6;
        }
      
.wrap{
  position:absolute;
  top:20px;
  right:20px;
	width:150px;
	height:150px;
	border-radius:50%;
	position:absolute;
/* 	top:calc(50% - 150px);
	left:calc(50% - 150px); */
	box-shadow: 0 0 9px red;
}
 
 
#timer{
	position:absolute;
	top:50px;
	right:50px;
	font-size:38px;
}
      body
      {
        position:relative;
      }
      iframe
      {
        
        position:absolute;
        top:350px;
        width:100%;
/*         width=fixed; */
        display:none;
      }

    </style>

</head>
<body>
  <div class="modal" id = "my-modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Crossword Puzzle Challenge</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <input id="NameBox" class="NameBox" value="" placeholder="first and last name"/>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="begintime()">Close</button>
      </div>
    </div>
  </div>
</div>
      
<!--   <div class = "name"><label>Your name:</label><input id="NameBox" class="NameBox" value="" placeholder="Input Your name!"/></div>
   -->
  <div class = "Title" id ="Question"></div>
   
<div class="wrap">
    <div id="timer" >
        <span id="second">00</span>
    </div>
</div>

  <div>
  <input id="test" class="InputBox" value="" placeholder="Input Your answer!"/>
<!--     Respect -->
    <button class="SubmitButton"  onClick = "fun()">Submit</button>
    <button class="HelpButton" onClick = "switchQ()">Switch</button>
  </div>
  <center>
 
      <iframe id="SuccessImg" z-index = 7  frameborder="0" scrolling="no" src="success"   ></iframe>
  </center>
</body>
  
<script>
  
  var currq;

     function fun(){
       second = document.getElementById("second");
       StudentName = document.getElementById("NameBox");
       QuestionString = document.getElementById("Question");
       AnswerString = document.getElementById("test");
      var information = 
                {
                  To:'teacher',
                  From:StudentName.value,
                  Question:QuestionString.innerText,
                  Answer:AnswerString.value,
                  Time:second.innerText,
                }
            var informationJSON = JSON.stringify(information);
            socket.send(informationJSON);
        }
      //use for connection
      var url = window.location.href;

      var socket = new WebSocket('wss://p3-websockets-TLHHWK-hwke19895462.codeanyapp.com/ws/draw');
    
    socket.onmessage = function(receivedMessage) 
      {
        StudentNamehh = document.getElementById("NameBox");
        var data = JSON.parse(receivedMessage.data);
        
        if(url == 'https://p3-websockets-tlhhwk-hwke19895462.codeanyapp.com/draw/studentinterface'){
          if(data.From == 'server' && data.To==StudentNamehh.value) { 
            if (data.Result == false) {
              switchQ();
            } if (data.Result == true)  {
              QuestionString = document.getElementById("Question");
              QuestionString.innerText=dic[currq];
              
              
            }
          
          }
          
          if(data.To==StudentNamehh.value)
          {
          if(data.Back==true){
            //BINGO SCREEN 
              document.getElementById("SuccessImg").style.display= "block"; 
              stop();
              alert(data.Reason);
         // $("#timer").hide();
          
         // clearInterval(timer);
        }
          else if (data.Back==false)
          {
            alert(data.Reason);  
          } 
          
      }
          
          
      }
      
      
      
      };
    socket.onopen = function(event)
      {
        
      };
        
    // notify console if socket closes unexpectedly
    socket.onclose = function(e) 
      {
      console.error('Chat socket closed unexpectedly');
      };
  
  //timer

      function switchQ(){
         currq = nextq(currq);

         StudentName = document.getElementById("NameBox");

        var feedback=
        {
            To: 'server',
            From: StudentName.value,
            Question: dic[currq],
            
        }
        var informationJSON = JSON.stringify(feedback);
            socket.send(informationJSON);
      }
   
  function nextq(x){
    if (x == 17) {
      return 1;
    } else {
      return x + 1;
    }
  }
  
  window.onload = function(){
    $('#my-modal').modal('show');
    var height = $(window).height() - 200;

    QuestionString = document.getElementById("Question");
    currq = Math.floor(Math.random() * (Math.floor(17) - Math.ceil(1) + 1)) + Math.ceil(1);
    QuestionString.innerText=dic[currq];
   		

   
}
   
  var second=null;
  var timer = null;
  function stop()
  {
		clearInterval(timer);
	}
  function begintime()
  {
    second = document.getElementById("second");
		var  Second = 0;
    timer = setInterval(function()
      {
			Second++;
			if(Second < 10){
				second.innerText = "0" + Second;
			}else{
				second.innerText = Second;
			}
		},1000)
 
  }
  //for random question
  var dic = { 		
      1:'HCI stands for Human computer answer',
			2:'First phase of design cycle',
			3:'Second phase of design cycle',
			4:'Third phase of design cycle',
			5:'Architectural representation of a user interface',
			6:'Relationship between person and object',
			7:'Physical ornament on object copied from an object when made from another materia',
			8:'How many waves are there in paradigms of HCI',
			9:'Model of a user that helps us think about users',
			10:'Users normally have three goals life end and ANSWER goals',
			11:'The Belmont principles are beneficence justice and ANSWER',
			12:'First phase of action cycle',
			13:'Second phase of action cycle',
			14:'Third phase of action cycle',
			15:'ANSWER walkthrough is when you pretend to be the user and walk through tasks',
      16:'ANSWER usability effect describes paradox that people think more aesthetic designs as more intuitive',
      17:'ANSWER tscale questions ask participants to express degree of agreement with a statement',
  };
</script>
</html>